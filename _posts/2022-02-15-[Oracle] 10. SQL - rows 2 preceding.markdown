---
layout: post
title: "[Oracle] 10. SQL - rows 2 preceding"
date: 2022-02-15 15:26:00 +0900
category: oracle
---

# 1. rows 2 preceding

### 사용처
이동평균과 이동총계를 구하고 싶을 때 사용한다.

```sql
create tablee idotT(sortkey, val) as
select 1,  10 from dual
union all
select 2,  20 from dual
union all
select 5,  60 from dual
union all
select 7, 100 from dual
union all
select 8, 200 from dual
union all
select 9, 600 from dual
```

sortkey를 오름차순으로, 앞 2행과 자신의 행을 가산대상으로 하여 이동총계를 구해보자

```sql
select sortkey,
       val,
       sum(val) over(order by sortkey rows 2 preceding) as moveSum
from   idotT;
```

```sql
sortkey  val  moveSum
-------  ---  -------
      1   10       10
      2   20       30
      5   60       90
      7  100      180
      8  200      360
      9  600      900
```