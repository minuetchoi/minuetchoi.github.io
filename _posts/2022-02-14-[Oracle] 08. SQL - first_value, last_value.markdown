---
layout: post
title: "[Oracle] 08. SQL - first_value, last_value"
date: 2022-02-15 13:40:00 +0900
category: oracle
---

# 1. first_value, last_value


### 사용처
최초값과 최종값을 구하고 싶을 때 사용


first_value함수는 지정한 sortkey에서, 최초행 값을 구하고 싶을 때 사용한다.

<br>

last_value함수는 지정한 sortkey에서, 최종행을 값을 구하고 싶을 때 사용한다.

<br>

Oracle11g R2에서는 nth_value함수가 추가되었다.

```sql
create table sampleT08(id, sortkey, val) as
select 111, 1, 100 from dual
union all
select 111, 3, 500 from dual
union all
select 111, 9, 300 from dual
union all
select 222, 2, 400 from dual
union all
select 222, 4, 600 from dual
union all
select 333, 5, 800 from dual;
```

<br>

id 마다, sortkey를 오름차순으로 최초행의 val과 최종행의 val을 구해보자

```sql
select id,
       sortkey,
       first_value(val) over(partition by id order by sortkey) as firstVal,
       val,
       last_value(val) over(partition by id order by sortkey
           rows between unbounded preceding and unbounded following) as lastVal)
from   sampleT08;
```

```sql
 id sortkey firstVal val lastVal
--- ------- -------- --- -------
111       1      100 100     300
111       3      100 500     300
111       9      100 300     300
222       2      400 400     600
222       4      400 600     600
333       5      800 800     800
```