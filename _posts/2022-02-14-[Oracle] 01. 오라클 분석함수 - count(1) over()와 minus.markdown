---
layout: post
title: "[Oracle] 02. 오라클 분석함수 - count(*) over() 와 minus"
date: 2022-02-14 13:40:00 +0900
category: oracle
---

# 1. count(*) over() 와 minus


### 사용처
데이터 이관 혹은 백업한 테이블과 데이터를 비교할 때 사용합니다.

SQL 튜닝후에, 2개의 select문 결과가 일치하는지를 확인할 때 사용합니다.

```sql
create table compA(ID number, Val number);
create table compB(ID number, Val number);
```

<br>

## 1-1. case1 (compA와 compB가 일치)
```sql
truncate table compA;
truncate table compB;
insert into compA values(10, 111);
insert into compB values(20, 222);
insert into compB values(10, 111);
insert into compB values(20, 222);
```

<br>

## 1-2. case2 (compA와 compB가 불일치)
```sql
truncate table compA;
truncate table compB;
insert into compA values(10, 111);
insert into compB values(10, 111);
insert into compB values(20, 222);
```

<br>

## 1-2. case3 (compA와 compB가 불일치)
```sql
truncate table compA;
truncate table compB;
insert into compA values(10, 111);
insert into compA values(20, 222);
insert into compB values(10, 111);
```

<br>

## 1-3. compA와 compB의 데이터가 일치하는지 비교
```sql
select a.*, count(*) over() from compA a
minus
select b.*, count(*) over() from compB b;
```


<br>

# 조회결과

case1의 경우 레코드 0건

case2의 경우 레코드 0건 

case3의 경우 레코드 1건
```sql
ID VAL
-- ---
10 222
```

  