---
layout: post
title: "[Oracle] 06. SQL - sum(val) over(order by sortkey)"
date: 2022-02-15 12:40:00 +0900
category: oracle
---

# 1. sum(val) over(order by sortkey)


### 사용처
파티션 별로 총합을 구하고 싶을 때 사용한다.

order by를 지정한 분석함수는 <mark style="background-color: #ffdce0">sum함수</mark> 이다.

<br>

```sql
create table sampleT07(id, sortkey, val) as
select 111, 1,  1 from dual
union all
select 111, 3,  2 from dual
union all
select 111, 5,  6 from dual
union all
select 222, 1, 10 from dual
union all
select 222, 2, 20 from dual
union all
select 222, 3, 60 from dual
union all
select 222, 4,  6 from dual
union all
select 333, 1,  1 from dual
union all
select 333, 2,  2 from dual
union all
select 333, 3, 20 from dual
union all
select 333, 3, 30 from dual;
```

<br>

id 마다, sortkey를 오름차순으로 총계를 구해보자

```sql
select id,
       sortkey,
       val,
       sum(val) over(partition by id order by sortkey) as runSum
from   sampleT06;
```

```sql
 id sortkey val runSum
--- ------- --- ------
111       1   1      1
111       3   2      3
111       5   6      9
222       1  10     10
222       2  20     30
222       3  60     90
222       4   6     96
333       1   1      1
333       2   2      3
333       3  20     53
333       3  30     53
```